<!DOCTYPE html>
<html>
<head>
  <title>Snake & Ladder Game</title>
  <style>
    .container {
      position: relative;
      width: 500px;
      height: 500px;

    }

    table {
      border-collapse: collapse;
      width: 100%;
      height: 100%;
    }

    td {
      border: 1px solid black;
      text-align: center;
      font-weight: bold;
      position: relative;
    }

    canvas {
      position: absolute;
      top: 0;
      left: 0;
      pointer-events: none;
      z-index: 1;
    }

    .player {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      position: absolute;
      z-index: 2;
    }

    .player1 {
      background-color: red;
      top: 5px;
      left: 5px;
    }

    .player2 {
      background-color: blue;
      top: 25px;
      left: 25px;
    }

    #dice, #turn {
      font-weight: bold;
      margin-top: 10px;
    }
  </style>
</head>
<body>

<h2>🎲 Snake & Ladder Game </h2>

<div class="container">
  <table id="board"></table>
  <canvas id="boardCanvas" width="500" height="500"></canvas>
</div>

<button onclick="rollDice()">Roll Dice</button>
<div id="dice">Dice: -</div>
<div id="turn">Current Turn: Player 1 (🔴)</div>

<script>
  const board = document.getElementById("board");
  const canvas = document.getElementById("boardCanvas");
  const ctx = canvas.getContext("2d");

  const p1 = document.createElement("div");
  p1.className = "player player1";
  const p2 = document.createElement("div");
  p2.className = "player player2";

  let p1Pos = 1;
  let p2Pos = 1;
  let currentPlayer = 1;

  const ladders = { 7: 67, 16: 94, 24: 98, 39: 77 };
  const snakes  = { 99: 17, 88: 9, 75: 41, 51: 27 };

  const cellMap = {};

  // Build table grid
  let current = 100;
  for (let row = 0; row < 10; row++) {
    const tr = document.createElement("tr");
    for (let col = 0; col < 10; col++) {
      const td = document.createElement("td");
      const num = (row % 2 === 0) ? current - (9 - col) : current - col;
      td.id = `cell-${num}`;
      td.textContent = num;
      tr.appendChild(td);
      cellMap[num] = td;
    }
    current -= 10;
    board.appendChild(tr);
  }

  // Add players
  cellMap[p1Pos].appendChild(p1);
  cellMap[p2Pos].appendChild(p2);

  // Dice roll
  function rollDice() {
    const diceVal = Math.floor(Math.random() * 6) + 1;
    document.getElementById("dice").textContent = `Dice: ${diceVal}`;

    if (currentPlayer === 1) {
      movePlayer(p1, 'p1Pos', diceVal);
      currentPlayer = 2;
      document.getElementById("turn").textContent = "Current Turn: Player 2 (🔵)";
    } else {
      movePlayer(p2, 'p2Pos', diceVal);
      currentPlayer = 1;
      document.getElementById("turn").textContent = "Current Turn: Player 1 (🔴)";
    }
  }

  function movePlayer(playerDiv, posVar, diceVal) {
    let pos = (posVar === 'p1Pos') ? p1Pos : p2Pos;
    let newPos = pos + diceVal;

    if (newPos > 100) newPos = pos;

    if (ladders[newPos]) {
      alert("🪜 Ladder! Go up to " + ladders[newPos]);
      newPos = ladders[newPos];
    }

    if (snakes[newPos]) {
      alert("🐍 Snake! Go down to " + snakes[newPos]);
      newPos = snakes[newPos];
    }

    if (posVar === 'p1Pos') {
      p1Pos = newPos;
      cellMap[p1Pos].appendChild(playerDiv);
    } else {
      p2Pos = newPos;
      cellMap[p2Pos].appendChild(playerDiv);
    }

    if (newPos === 100) {
      setTimeout(() => {
        alert((posVar === 'p1Pos' ? "Player 1 🔴" : "Player 2 🔵") + " wins! 🎉");
        resetGame();
      }, 100);
    }
  }

  function resetGame() {
    p1Pos = 1;
    p2Pos = 1;
    currentPlayer = 1;
    document.getElementById("turn").textContent = "Current Turn: Player 1 (🔴)";
    cellMap[p1Pos].appendChild(p1);
    cellMap[p2Pos].appendChild(p2);
  }

  // Canvas drawing helpers
  function getCellCenter(pos) {
    const cell = document.getElementById(`cell-${pos}`);
    const rect = cell.getBoundingClientRect();
    const tableRect = board.getBoundingClientRect();
    return {
      x: rect.left - tableRect.left + rect.width / 2,
      y: rect.top - tableRect.top + rect.height / 2
    };
  }

  function drawLadder(start, end) {
    const a = getCellCenter(start);
    const b = getCellCenter(end);
    ctx.strokeStyle = "green";
    ctx.lineWidth = 4;
    ctx.beginPath();
    ctx.moveTo(a.x, a.y);
    ctx.lineTo(b.x, b.y);
    ctx.stroke();
  }

  function drawSnake(start, end) {
    const a = getCellCenter(start);
    const b = getCellCenter(end);
    ctx.strokeStyle = "red";
    ctx.lineWidth = 4;
    ctx.beginPath();
    ctx.moveTo(a.x, a.y);
    ctx.bezierCurveTo(
      a.x - 50, a.y + 60,
      b.x + 50, b.y - 60,
      b.x, b.y
    );
    ctx.stroke();
  }

  // Wait for layout then draw
  window.onload = function () {
    for (let [from, to] of Object.entries(ladders)) {
      drawLadder(Number(from), Number(to));
    }
    for (let [from, to] of Object.entries(snakes)) {
      drawSnake(Number(from), Number(to));
    }
  };
</script>

</body>
</html>